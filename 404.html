<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop - Enhanced Customer Experience</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#fff1f2',
                            100: '#ffe4e6',
                            200: '#fecdd3',
                            300: '#fda4af',
                            400: '#fb7185',
                            500: '#f43f5e',
                            600: '#e11d48',
                            700: '#be123c',
                            800: '#9f1239',
                            900: '#881337',
                        },
                        secondary: {
                            50: '#fdf4ff',
                            100: '#fae8ff',
                            200: '#f5d0fe',
                            300: '#f0abfc',
                            400: '#e879f9',
                            500: '#d946ef',
                            600: '#c026d3',
                            700: '#a21caf',
                            800: '#86198f',
                            900: '#701a75',
                        },
                        accent: {
                            50: '#fffbeb',
                            100: '#fef3c7',
                            200: '#fde68a',
                            300: '#fcd34d',
                            400: '#fbbf24',
                            500: '#f59e0b',
                            600: '#d97706',
                            700: '#b45309',
                            800: '#92400e',
                            900: '#78350f',
                        }
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-slow': 'bounce 2s infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'slideUp': 'slideUp 0.6s forwards',
                        'slideIn': 'slideIn 0.3s ease',
                        'fadeIn': 'fadeIn 0.3s ease',
                        'ripple': 'ripple 600ms linear',
                        'heartbeat': 'heartbeat 0.6s ease-in-out',
                        'spin': 'spin 1s linear infinite'
                    }
                }
            }
        }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #f43f5e 0%, #d946ef 100%);
            --secondary-gradient: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            --success-gradient: linear-gradient(135deg, #34d399 0%, #10b981 100%);
            --danger-gradient: linear-gradient(135deg, #f87171 0%, #ef4444 100%);
            --dark-bg: #1e293b;
            --card-bg: rgba(255, 255, 255, 0.95);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --shadow-light: 0 8px 32px rgba(244, 63, 94, 0.15);
            --shadow-heavy: 0 20px 60px rgba(244, 63, 94, 0.15);
        }

        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--primary-gradient);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* Animated background particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0px) rotate(0deg);
            }

            50% {
                transform: translateY(-20px) rotate(180deg);
            }
        }

        /* Header */
        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            transition: all 0.3s ease;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }

        .logo {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(45deg, #fff, #f0f0f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .search-container {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px 15px 50px;
            border: none;
            border-radius: 50px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            font-size: 16px;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            transform: translateY(-2px);
            box-shadow: var(--shadow-heavy);
        }

        .search-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 20px;
            color: var(--text-secondary);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .view-toggle {
            display: flex;
            background: var(--card-bg);
            border-radius: 25px;
            padding: 5px;
            box-shadow: var(--shadow-light);
        }

        .view-btn {
            padding: 8px 12px;
            border: none;
            background: transparent;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .view-btn.active {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .cart-button {
            background: var(--success-gradient);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: var(--shadow-light);
        }

        .cart-button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-heavy);
        }

        .cart-count {
            background: #ef4444;
            color: white;
            border-radius: 50%;
            padding: 4px 8px;
            font-size: 12px;
            font-weight: bold;
            min-width: 20px;
            text-align: center;
            position: absolute;
            top: -5px;
            right: -5px;
            animation: bounce 0.5s ease-in-out;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.2);
            }
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .filters-section {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: flex-end;
        }

        .filter-group {
            display: none;
            /* Hide category filters */
        }

        .filter-btn {
            padding: 10px 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .filter-btn.active,
        .filter-btn:hover {
            background: var(--card-bg);
            color: var(--text-primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .sort-select {
            padding: 10px 15px;
            border: none;
            border-radius: 20px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-light);
            cursor: pointer;
        }

        /* Products Grid */
        .products-grid {
            display: grid;
            gap: 30px;
            margin-bottom: 40px;
            transition: all 0.3s ease;
        }

        .grid-view {
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        }

        .list-view {
            grid-template-columns: 1fr;
        }

        .product-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            overflow: hidden;
            box-shadow: var(--shadow-light);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.2);
            opacity: 0;
        }

        .product-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: var(--shadow-heavy);
        }

        .product-card.list-view {
            display: flex;
            /* max-height: 200px; */
        }

        .product-card.list-view .image-gallery {
            width: 250px;
            flex-shrink: 0;
        }

        .product-card.list-view .product-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .image-gallery {
            position: relative;
            overflow: hidden;
            height: 280px;
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: transform 0.5s ease;
        }

        .product-card:hover .product-image {
            transform: scale(1.1);
        }

        .image-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.7) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .product-card:hover .image-overlay {
            opacity: 1;
        }

        .quick-actions {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.3s ease;
        }

        .product-card:hover .quick-actions {
            opacity: 1;
            transform: translateX(0);
        }

        .quick-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .quick-btn:hover {
            transform: scale(1.1);
            background: var(--primary-gradient);
            color: white;
        }

        .image-navigation {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
        }

        .image-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .image-dot.active,
        .image-dot:hover {
            background: white;
            transform: scale(1.2);
        }

        .image-counter {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            backdrop-filter: blur(10px);
        }

        .product-info {
            padding: 25px;
        }

        .product-category {
            color: #f43f5e;
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 8px;
        }

        .product-name {
            font-size: 22px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .product-description {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.6;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .product-price {
            font-size: 28px;
            font-weight: 800;
            background: var(--success-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }

        .product-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .add-to-cart-btn {
            background: var(--primary-gradient);
            color: white;
            padding: 14px 24px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            flex: 1;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
        }

        .add-to-cart-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-heavy);
        }

        .add-to-cart-btn:disabled {
            background: #ddd;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .view-details-btn {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            color: var(--text-primary);
            padding: 14px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .view-details-btn:hover {
            background: var(--card-bg);
            transform: translateY(-2px);
        }

        .out-of-stock-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            font-weight: bold;
            backdrop-filter: blur(5px);
        }

        /* Product Detail Modal */
        .product-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .product-modal-content {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            width: 95%;
            max-width: 1000px;
            margin: 2% auto;
            border-radius: 25px;
            overflow: hidden;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-heavy);
            animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px) scale(0.9);
                opacity: 0;
            }

            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .close-modal {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: var(--danger-gradient);
            color: white;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            transform: scale(1.1) rotate(90deg);
        }

        .modal-body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            padding: 30px;
        }

        .modal-image-gallery {
            position: relative;
        }

        .modal-main-image {
            width: 100%;
            height: 400px;
            object-fit: contain;
            border-radius: 15px;
            box-shadow: var(--shadow-light);
            cursor: zoom-in;
            transition: transform 0.3s ease;
        }

        .modal-main-image:hover {
            transform: scale(1.05);
        }

        .modal-thumbnail-strip {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            overflow-x: auto;
            padding: 10px 0;
        }

        .modal-thumbnail {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 10px;
            cursor: pointer;
            opacity: 0.6;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .modal-thumbnail.active,
        .modal-thumbnail:hover {
            opacity: 1;
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .modal-product-info h2 {
            font-size: 32px;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .modal-product-category {
            color: #f43f5e;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
        }

        .modal-product-price {
            font-size: 36px;
            font-weight: 800;
            background: var(--success-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }

        .modal-product-description {
            color: var(--text-secondary);
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 30px;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
        }

        .modal-add-to-cart {
            background: var(--primary-gradient);
            color: white;
            padding: 18px 36px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            flex: 1;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
        }

        .modal-add-to-cart:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-heavy);
        }

        /* Cart Modal */
        .cart-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .cart-modal-content {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            width: 95%;
            max-width: 700px;
            margin: 2% auto;
            border-radius: 25px;
            overflow: hidden;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-heavy);
            animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .cart-header {
            background: var(--primary-gradient);
            color: white;
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-header h2 {
            font-size: 28px;
            font-weight: 800;
        }

        .close-cart {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            color: white;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-cart:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1) rotate(90deg);
        }

        .cart-body {
            padding: 30px;
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            gap: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .cart-item:hover {
            transform: translateX(5px);
            background: rgba(255, 255, 255, 0.8);
        }

        .cart-item-image {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 700;
            font-size: 18px;
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .cart-item-price {
            color: #f43f5e;
            font-weight: 600;
            font-size: 16px;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
        }

        .quantity-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .quantity-btn:hover {
            transform: scale(1.1);
        }

        .quantity {
            font-weight: 800;
            font-size: 18px;
            min-width: 30px;
            text-align: center;
            color: var(--text-primary);
        }

        .remove-item {
            background: var(--danger-gradient);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .remove-item:hover {
            transform: translateY(-2px);
        }

        .cart-total {
            background: var(--primary-gradient);
            color: white;
            padding: 25px;
            text-align: center;
            font-size: 24px;
            font-weight: 800;
            margin: 20px 0;
            border-radius: 15px;
            box-shadow: var(--shadow-light);
        }

        .checkout-form {
            padding: 20px;
            border-top: 2px solid rgba(0, 0, 0, 0.1);
        }

        .checkout-actions {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .checkout-btn {
            background: var(--success-gradient);
            color: white;
            padding: 18px 30px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            flex: 1;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
            position: relative;
            overflow: hidden;
        }

        .checkout-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-heavy);
        }

        .clear-cart-btn {
            background: var(--danger-gradient);
        }

        .empty-cart {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-cart-icon {
            font-size: 80px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .alert {
            padding: 20px;
            margin: 20px 0;
            border-radius: 15px;
            font-weight: 600;
            backdrop-filter: blur(10px);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .alert-success {
            background: rgba(76, 175, 80, 0.2);
            color: #2e7d32;
            border: 2px solid rgba(76, 175, 80, 0.3);
        }

        .alert-error {
            background: rgba(244, 67, 54, 0.2);
            color: #c62828;
            border: 2px solid rgba(244, 67, 54, 0.3);
        }

        /* Image Zoom Modal - Fixed to prevent image cutoff */
        .zoom-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
            overflow: auto;
        }

        .zoom-content {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .zoom-image {
            max-width: 90%;
            max-height: 90vh;
            object-fit: contain;
            border-radius: 15px;
            box-shadow: var(--shadow-heavy);
        }

        .zoom-close {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            color: var(--text-primary);
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 2001;
        }

        .zoom-close:hover {
            transform: scale(1.1) rotate(90deg);
            background: var(--danger-gradient);
            color: white;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .modal-body {
                grid-template-columns: 1fr;
                gap: 30px;
            }

            .modal-main-image {
                height: 300px;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-wrap: wrap;
                gap: 15px;
            }

            .search-container {
                order: 3;
                width: 100%;
            }

            .logo {
                font-size: 24px;
            }

            .products-grid.grid-view {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 20px;
            }

            .product-card.list-view {
                flex-direction: column;
                max-height: none;
            }

            .product-card.list-view .image-gallery {
                width: 100%;
                height: 200px;
            }

            .container {
                padding: 20px 15px;
            }

            .filters-section {
                justify-content: center;
            }

            .cart-modal-content,
            .product-modal-content {
                margin: 5% auto;
                width: 98%;
            }
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 60px;
            color: white;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        /* Notification Toast */
        .toast {
            position: fixed;
            top: 100px;
            right: 30px;
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            padding: 20px 25px;
            border-radius: 15px;
            box-shadow: var(--shadow-heavy);
            z-index: 2000;
            transform: translateX(400px);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast-success {
            border-left: 5px solid #4caf50;
        }

        .toast-error {
            border-left: 5px solid #f44336;
        }

        .toast-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .toast-icon {
            font-size: 24px;
        }

        .toast-message {
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Wishlist Button */
        .wishlist-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #ccc;
        }

        .wishlist-btn.active {
            color: #e74c3c;
            animation: heartbeat 0.6s ease-in-out;
        }

        @keyframes heartbeat {
            0% {
                transform: scale(1);
            }

            14% {
                transform: scale(1.3);
            }

            28% {
                transform: scale(1);
            }

            42% {
                transform: scale(1.3);
            }

            70% {
                transform: scale(1);
            }
        }

        /* Add ripple effect CSS */
        .ripple {
            position: absolute;
            border-radius: 50%;
            transform: scale(0);
            animation: ripple 600ms linear;
            background-color: rgba(255, 255, 255, 0.6);
            pointer-events: none;
        }

        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        /* Add position relative to all buttons to contain the ripple */
        button {
            position: relative;
            overflow: hidden;
        }

        /* New styles for enhanced UI */
        .hero-section {
            text-align: center;
            padding: 60px 20px;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .hero-title {
            font-size: 48px;
            font-weight: 800;
            background: linear-gradient(45deg, #fff, #f0f0f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }

        .hero-subtitle {
            font-size: 20px;
            color: rgba(255, 255, 255, 0.9);
            max-width: 700px;
            margin: 0 auto 30px;
        }

        .hero-cta {
            background: var(--success-gradient);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
        }

        .hero-cta:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-heavy);
        }

        .category-pills {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .category-pill {
            padding: 12px 25px;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            color: white;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .category-pill.active,
        .category-pill:hover {
            background: var(--card-bg);
            color: var(--text-primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .product-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            z-index: 10;
        }

        .badge-new {
            background: var(--secondary-gradient);
            color: white;
        }

        .badge-sale {
            background: var(--danger-gradient);
            color: white;
        }

        .badge-trending {
            background: var(--accent-500, #f59e0b);
            color: white;
        }

        .image-arrows {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 15px;
            transform: translateY(-50%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .image-gallery:hover .image-arrows {
            opacity: 1;
        }

        .arrow-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .arrow-btn:hover {
            transform: scale(1.1);
            background: var(--primary-gradient);
            color: white;
        }

        .floating-cart {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--success-gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: var(--shadow-heavy);
            z-index: 90;
            transition: all 0.3s ease;
            animation: bounce-slow 2s infinite;
        }

        .floating-cart:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .floating-cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .floating-wishlist {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--danger-gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: var(--shadow-heavy);
            z-index: 90;
            transition: all 0.3s ease;
        }

        .floating-wishlist:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .floating-wishlist-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .floating-scroll-top {
            position: fixed;
            bottom: 170px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary-gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: var(--shadow-heavy);
            z-index: 90;
            transition: all 0.3s ease;
            opacity: 0;
            pointer-events: none;
        }

        .floating-scroll-top.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .floating-scroll-top:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 10px;
        }

        .rating-stars {
            color: #fbbf24;
            font-size: 16px;
        }

        .rating-count {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .product-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .product-sku {
            font-weight: 600;
        }

        .product-stock {
            color: #10b981;
            font-weight: 600;
        }

        .product-stock.low {
            color: #f59e0b;
        }

        .product-stock.out {
            color: #ef4444;
        }

        .discount-price {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .original-price {
            text-decoration: line-through;
            color: var(--text-secondary);
            font-size: 18px;
        }

        .discount-percent {
            background: var(--danger-gradient);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
        }

        .color-options {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .color-option {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .color-option.active {
            border-color: var(--text-primary);
            transform: scale(1.2);
        }

        .size-options {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .size-option {
            padding: 8px 12px;
            background: var(--glass-bg);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
        }

        .size-option.active,
        .size-option:hover {
            background: var(--primary-gradient);
            color: white;
        }

        .social-share {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .share-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .share-btn:hover {
            transform: scale(1.1);
            background: var(--primary-gradient);
            color: white;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin: 60px 0;
        }

        .feature-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-heavy);
        }

        .feature-icon {
            font-size: 50px;
            margin-bottom: 20px;
        }

        .feature-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .feature-description {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .newsletter-section {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            margin: 60px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .newsletter-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #fff, #f0f0f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .newsletter-description {
            color: rgba(255, 255, 255, 0.9);
            max-width: 600px;
            margin: 0 auto 30px;
            font-size: 18px;
        }

        .newsletter-form {
            display: flex;
            max-width: 500px;
            margin: 0 auto;
            gap: 15px;
        }

        .newsletter-input {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 50px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            font-size: 16px;
        }

        .newsletter-input:focus {
            outline: none;
            box-shadow: var(--shadow-light);
        }

        .newsletter-btn {
            background: var(--primary-gradient);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .newsletter-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-heavy);
        }

        .footer {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding: 60px 0 30px;
            margin-top: 60px;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
        }

        .footer-column h3 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            color: white;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 15px;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .footer-links a:hover {
            color: white;
            transform: translateX(5px);
        }

        .footer-social {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .social-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .social-icon:hover {
            background: var(--primary-gradient);
            transform: translateY(-3px);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 40px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --card-bg: rgba(30, 41, 59, 0.95);
                --text-primary: #f1f5f9;
                --text-secondary: #94a3b8;
            }
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            :root {
                --primary-gradient: linear-gradient(135deg, #ff0000 0%, #0000ff 100%);
                --shadow-light: 0 8px 32px rgba(0, 0, 0, 0.5);
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>

<body class="bg-gradient-to-br from-primary-500 to-secondary-700">
    <!-- Animated Background Particles -->
    <div class="particles" id="particles"></div>

    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo">üõí Modern Shop</div>
            <div class="search-container">
                <div class="search-icon">üîç</div>
                <input type="text" id="searchInput" class="search-input" placeholder="Search products...">
            </div>
            <div class="header-actions">
                <div class="view-toggle">
                    <button class="view-btn active" onclick="toggleView('grid')" title="Grid View">‚äû</button>
                    <button class="view-btn" onclick="toggleView('list')" title="List View">‚ò∞</button>
                </div>
                <button onclick="openCart()" style="overflow: visible;" class="cart-button">
                    <span>üõí</span>
                    <span>Cart</span>
                    <span id="cartCount" class="cart-count">0</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Hero Section -->
        <div class="hero-section">
            <h1 class="hero-title">Discover Amazing Products</h1>
            <p class="hero-subtitle">Explore our curated collection of high-quality products with exclusive deals and
                fast shipping.</p>
            <button class="hero-cta" onclick="scrollToProducts()">Shop Now</button>
        </div>

        <!-- Category Pills -->
        <div class="category-pills" id="categoryPills">
            <!-- Categories will be loaded here -->
        </div>

        <!-- Filters Section -->
        <div class="filters-section">
            <div class="filter-group">
                <!-- Category filters removed as requested -->
            </div>
            <select class="sort-select" id="sortSelect" onchange="sortProducts()">
                <option value="">Sort by</option>
                <option value="price-low">Price: Low to High</option>
                <option value="price-high">Price: High to Low</option>
                <option value="name">Name A-Z</option>
                <option value="newest">Newest First</option>
                <option value="rating">Highest Rated</option>
            </select>
        </div>

        <!-- Loading -->
        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <p>Loading amazing products...</p>
        </div>

        <!-- Products Grid -->
        <div id="productsGrid" class="products-grid grid-view">
            <!-- Products will be loaded here -->
        </div>

        <!-- Features Section -->
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">üöö</div>
                <h3 class="feature-title">Free Shipping</h3>
                <p class="feature-description">Free shipping on all orders over $50. Fast delivery to your doorstep.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">‚Ü©Ô∏è</div>
                <h3 class="feature-title">Easy Returns</h3>
                <p class="feature-description">30-day money-back guarantee. No questions asked return policy.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üîí</div>
                <h3 class="feature-title">Secure Payment</h3>
                <p class="feature-description">Your payment information is safe with our encrypted checkout process.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üëç</div>
                <h3 class="feature-title">Quality Guarantee</h3>
                <p class="feature-description">We carefully vet all products to ensure the highest quality standards.
                </p>
            </div>
        </div>

        <!-- Newsletter Section -->
        <div class="newsletter-section">
            <h2 class="newsletter-title">Stay Updated</h2>
            <p class="newsletter-description">Subscribe to our newsletter for exclusive deals, new arrivals, and style
                tips.</p>
            <div class="newsletter-form">
                <input type="email" class="newsletter-input" placeholder="Your email address">
                <button class="newsletter-btn">Subscribe</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="footer-content">
            <div class="footer-column">
                <h3>Modern Shop</h3>
                <p style="color: rgba(255,255,255,0.8); margin-bottom: 20px; line-height: 1.6;">Your one-stop
                    destination for quality products at amazing prices.</p>
                <div class="footer-social">
                    <a href="#" class="social-icon">üìò</a>
                    <a href="#" class="social-icon">üì∏</a>
                    <a href="#" class="social-icon">üê¶</a>
                    <a href="#" class="social-icon">üìΩÔ∏è</a>
                </div>
            </div>
            <div class="footer-column">
                <h3>Shop</h3>
                <ul class="footer-links">
                    <li><a href="#">All Products</a></li>
                    <li><a href="#">New Arrivals</a></li>
                    <li><a href="#">Best Sellers</a></li>
                    <li><a href="#">Sale</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h3>Help</h3>
                <ul class="footer-links">
                    <li><a href="#">Contact Us</a></li>
                    <li><a href="#">FAQs</a></li>
                    <li><a href="#">Shipping & Returns</a></li>
                    <li><a href="#">Track Order</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h3>Contact</h3>
                <ul class="footer-links">
                    <li>üìû +91 9925629486</li>
                    <li>‚úâÔ∏è palajit29@gmail.com</li>
                    <li>üè¢ 123 Commerce St, City, Country</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>¬© 2023 Modern Shop. All rights reserved.</p>
        </div>
    </div>

    <!-- Floating Action Buttons -->
    <div class="floating-cart" onclick="openCart()">
        üõí
        <span class="floating-cart-count" id="floatingCartCount">0</span>
    </div>

    <div class="floating-wishlist" onclick="showWishlist()">
        ‚ô•
        <span class="floating-wishlist-count" id="floatingWishlistCount">0</span>
    </div>

    <div class="floating-scroll-top" id="scrollTopBtn" onclick="scrollToTop()">
        ‚Üë
    </div>

    <!-- Product Detail Modal -->
    <div id="productModal" class="product-modal">
        <div class="product-modal-content">
            <div class="modal-header">
                <h2>Product Details</h2>
                <button onclick="closeProductModal()" class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-image-gallery">
                    <img id="modalMainImage" src="" alt="" class="modal-main-image" onclick="zoomImage(this.src)">
                    <div id="modalThumbnailStrip" class="modal-thumbnail-strip">
                        <!-- Thumbnails will be populated here -->
                    </div>
                </div>
                <div class="modal-product-info">
                    <div id="modalProductCategory" class="modal-product-category"></div>
                    <h2 id="modalProductName"></h2>

                    <div class="product-rating">
                        <div class="rating-stars" id="modalProductRating"></div>
                        <div class="rating-count" id="modalRatingCount"></div>
                    </div>

                    <div class="discount-price">
                        <div id="modalProductPrice" class="modal-product-price"></div>
                        <div id="modalOriginalPrice" class="original-price"></div>
                        <div id="modalDiscountPercent" class="discount-percent"></div>
                    </div>

                    <div class="product-meta">
                        <div class="product-sku">SKU: <span id="modalProductSku"></span></div>
                        <div class="product-stock" id="modalProductStock"></div>
                    </div>

                    <div class="color-options" id="modalColorOptions">
                        <!-- Color options will be populated here -->
                    </div>

                    <div class="size-options" id="modalSizeOptions">
                        <!-- Size options will be populated here -->
                    </div>

                    <p id="modalProductDescription" class="modal-product-description"></p>

                    <div class="modal-actions">
                        <button id="modalAddToCart" class="modal-add-to-cart">Add to Cart</button>
                        <button class="wishlist-btn" onclick="toggleWishlist(currentProduct._id)"
                            title="Add to Wishlist">‚ô°</button>
                    </div>

                    <div class="social-share">
                        <button class="share-btn" title="Share on Facebook">üìò</button>
                        <button class="share-btn" title="Share on Twitter">üê¶</button>
                        <button class="share-btn" title="Share on Pinterest">üìå</button>
                        <button class="share-btn" title="Share via Email">‚úâÔ∏è</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Image Zoom Modal -->
    <div id="zoomModal" class="zoom-modal">
        <button onclick="closeZoomModal()" class="zoom-close">&times;</button>
        <div class="zoom-content">
            <img id="zoomImage" src="" alt="" class="zoom-image">
        </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="cart-modal">
        <div class="cart-modal-content">
            <div class="cart-header">
                <h2>Your Shopping Cart</h2>
                <button onclick="closeCart()" class="close-cart">&times;</button>
            </div>
            <div class="cart-body">
                <div id="cartItems">
                    <!-- Cart items will be displayed here -->
                </div>
                <div id="cartTotal" class="cart-total">
                    Total: ‚Çπ0
                </div>
                <div class="checkout-form">
                    <div class="checkout-actions">
                        <button onclick="checkAvailability()" class="checkout-btn">
                            üì± WhatsApp inquiry
                        </button>
                        <button onclick="clearCart()" class="checkout-btn clear-cart-btn">
                            üóëÔ∏è Clear Cart
                        </button>
                    </div>
                    <div id="orderAlert"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <div class="toast-content">
            <span class="toast-icon"></span>
            <span class="toast-message"></span>
        </div>
    </div>

    <script>
        // Configuration
        const API_BASE = 'http://localhost:5000/api';
        // const API_BASE = 'https://vf-be-1.onrender.com/api';

        // Global variables
        let products = [];
        let filteredProducts = [];
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
        let currentImageIndices = {};
        let currentProduct = null;
        let currentView = 'grid';
        let currentFilter = 'all';

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            createParticles();
            loadProducts();
            updateCartCount();
            updateWishlistCount();
            setupEventListeners();
            setupScrollTopButton();
        });

        // Create animated background particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Search functionality
            document.getElementById('searchInput').addEventListener('input', (e) => {
                searchProducts(e.target.value);
            });

            // Close modals on outside click
            window.addEventListener('click', (event) => {
                if (event.target.classList.contains('product-modal')) {
                    closeProductModal();
                }
                if (event.target.classList.contains('cart-modal')) {
                    closeCart();
                }
                if (event.target.classList.contains('zoom-modal')) {
                    closeZoomModal();
                }
            });

            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeProductModal();
                    closeCart();
                    closeZoomModal();
                }
            });

            // Add ripple effect to all buttons
            document.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', createRipple);
            });

            // Newsletter form submission
            document.querySelector('.newsletter-btn').addEventListener('click', (e) => {
                e.preventDefault();
                const email = document.querySelector('.newsletter-input').value;
                if (email && validateEmail(email)) {
                    showToast('success', 'Thanks for subscribing to our newsletter!');
                    document.querySelector('.newsletter-input').value = '';
                } else {
                    showToast('error', 'Please enter a valid email address.');
                }
            });
        }

        // Setup scroll to top button
        function setupScrollTopButton() {
            const scrollTopBtn = document.getElementById('scrollTopBtn');

            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    scrollTopBtn.classList.add('visible');
                } else {
                    scrollTopBtn.classList.remove('visible');
                }
            });
        }

        // Scroll to top function
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // Scroll to products function
        function scrollToProducts() {
            document.getElementById('productsGrid').scrollIntoView({
                behavior: 'smooth'
            });
        }

        // Show wishlist function
        function showWishlist() {
            // For demo purposes, show a toast message
            showToast('success', `You have ${wishlist.length} items in your wishlist!`);

            // In a real implementation, you would show a wishlist modal
            // openWishlistModal();
        }

        // Email validation
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        // Load products with loading animation
        async function loadProducts() {
            const loading = document.getElementById('loading');
            const grid = document.getElementById('productsGrid');

            loading.style.display = 'block';
            grid.style.display = 'none';

            try {
                // For demo purposes, we'll use mock data if the API is not available
                let response;
                try {
                    response = await fetch(`${API_BASE}/products`);
                    products = await response.json();
                } catch (error) {
                    console.error('API not available, using mock data:', error);
                    products = generateMockProducts();
                }

                filteredProducts = [...products]; // Show all products by default

                // Initialize current image indices
                products.forEach(product => {
                    currentImageIndices[product._id] = 0;
                });

                // Extract and display categories
                displayCategories();

                setTimeout(() => {
                    loading.style.display = 'none';
                    grid.style.display = 'grid';
                    displayProducts();
                }, 1000); // Add slight delay for better UX

            } catch (error) {
                console.error('Error loading products:', error);
                loading.style.display = 'none';
                grid.style.display = 'grid';
                grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; color: white; font-size: 18px; padding: 60px; background: rgba(255,255,255,0.1); border-radius: 20px; backdrop-filter: blur(10px);">
                        <div style="font-size: 60px; margin-bottom: 20px;">üòû</div>
                        <h3>Oops! Something went wrong</h3>
                        <p>Please make sure the server is running and try refreshing the page.</p>
                        <button onclick="loadProducts()" style="margin-top: 20px; padding: 15px 30px; background: var(--primary-gradient); color: white; border: none; border-radius: 25px; cursor: pointer; font-size: 16px;">
                            üîÑ Try Again
                        </button>
                    </div>
                `;
            }
        }

        // Generate mock products for demo purposes
        function generateMockProducts() {
            const mockProducts = [];
            const categories = ['Electronics', 'Clothing', 'Home & Kitchen', 'Beauty', 'Sports'];
            const names = [
                'Wireless Bluetooth Headphones', 'Smart Watch Series 5', 'Organic Cotton T-Shirt',
                'Stainless Steel Water Bottle', 'Yoga Mat Premium', 'LED Desk Lamp',
                'Wireless Charging Pad', 'Portable Power Bank', 'Noise Cancelling Earbuds',
                'Fitness Tracker', 'Leather Wallet', 'Smart Home Speaker',
                'Gaming Mouse', 'Mechanical Keyboard', '4K Ultra HD Monitor'
            ];

            for (let i = 0; i < 15; i++) {
                const category = categories[Math.floor(Math.random() * categories.length)];
                const name = names[i];
                const price = Math.floor(Math.random() * 200) + 20;
                const originalPrice = price + Math.floor(Math.random() * 100);
                const rating = (Math.random() * 2 + 3).toFixed(1); // 3-5 stars
                const reviewCount = Math.floor(Math.random() * 500);

                mockProducts.push({
                    _id: `mock-${i}`,
                    name: name,
                    price: price,
                    originalPrice: originalPrice,
                    category: category,
                    description: `This is a high-quality ${name.toLowerCase()} perfect for everyday use. Designed with premium materials and innovative technology.`,
                    images: [],
                    inStock: Math.random() > 0.2, // 80% chance of being in stock
                    rating: parseFloat(rating),
                    reviewCount: reviewCount,
                    sku: `SKU-${Math.floor(Math.random() * 10000)}`,
                    colors: ['#000000', '#FF0000', '#0000FF', '#00FF00'].slice(0, Math.floor(Math.random() * 3) + 1),
                    sizes: ['S', 'M', 'L', 'XL'].slice(0, Math.floor(Math.random() * 3) + 1)
                });
            }

            return mockProducts;
        }

        // Display categories
        function displayCategories() {
            const categoriesContainer = document.getElementById('categoryPills');
            const categories = [...new Set(products.map(product => product.category))];

            let categoriesHTML = '<button class="category-pill active" onclick="filterProducts(\'all\')">All Products</button>';

            categories.forEach(category => {
                categoriesHTML += `<button class="category-pill" onclick="filterProducts('${category}')">${category}</button>`;
            });

            categoriesContainer.innerHTML = categoriesHTML;
        }

        // Filter products by category
        function filterProducts(category) {
            currentFilter = category;

            // Update active state of category pills
            document.querySelectorAll('.category-pill').forEach(pill => {
                pill.classList.remove('active');
            });
            event.target.classList.add('active');

            if (category === 'all') {
                filteredProducts = [...products];
            } else {
                filteredProducts = products.filter(product => product.category === category);
            }

            displayProducts();
        }

        // Display products with enhanced animations
        function displayProducts() {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';

            if (filteredProducts.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; color: white; font-size: 18px; padding: 60px; background: rgba(255,255,255,0.1); border-radius: 20px; backdrop-filter: blur(10px);">
                        <div style="font-size: 60px; margin-bottom: 20px;">üîç</div>
                        <h3>No products found</h3>
                        <p>Try adjusting your search or filter criteria.</p>
                    </div>
                `;
                return;
            }

            filteredProducts.forEach((product, index) => {
                const productCard = createProductCard(product, index);
                grid.appendChild(productCard);
            });

            // Animate cards on load
            const cards = grid.querySelectorAll('.product-card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
                card.style.animation = 'slideUp 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards';
            });

            // Add swipe functionality to product images
            setupSwipeListeners();
        }

        // Create enhanced product card
        function createProductCard(product, index) {
            const productCard = document.createElement('div');
            productCard.className = `product-card ${currentView}-view`;
            productCard.dataset.productId = product._id;
            productCard.style.opacity = '0';
            productCard.tabIndex = 0;
            productCard.setAttribute('role', 'button');
            productCard.setAttribute('aria-label', `Product: ${product.name}`);

            // Generate random badge for demo
            const badges = ['new', 'sale', 'trending'];
            const randomBadge = badges[Math.floor(Math.random() * badges.length)];
            const badgeHTML = Math.random() > 0.5 ?
                `<div class="product-badge badge-${randomBadge}">${randomBadge.charAt(0).toUpperCase() + randomBadge.slice(1)}</div>` : '';

            // Handle multiple images with enhanced gallery
            let imageHtml = '';
            if (product.images && product.images.length > 0) {
                imageHtml = `
                    <div class="image-gallery">
                        ${badgeHTML}
                        <img src="${API_BASE.replace('/api', '')}/uploads/${product.images[0]}" 
                             alt="${product.name}" class="product-image">
                        <div class="image-overlay"></div>
                        <div class="quick-actions">
                            <button style="color: #e74c3c;" class="quick-btn wishlist-btn ${wishlist.includes(product._id) ? 'active' : ''}" 
                                    onclick="event.stopPropagation(); toggleWishlist('${product._id}')" title="Add to Wishlist">
                                ${wishlist.includes(product._id) ? '‚ô•' : '‚ô°'}
                            </button>
                            <button class="quick-btn" onclick="event.stopPropagation(); openProductModal('${product._id}')" title="Quick View">üëÅ</button>
                            <button class="quick-btn" onclick="event.stopPropagation(); zoomImage('${API_BASE.replace('/api', '')}/uploads/${product.images[0]}')" title="Zoom">üîç</button>
                        </div>
                        ${product.images.length > 1 ? `
                            <div class="image-counter">1/${product.images.length}</div>
                            <div class="image-navigation">
                                ${product.images.map((_, imgIndex) =>
                    `<div class="image-dot ${imgIndex === 0 ? 'active' : ''}" 
                                         onclick="event.stopPropagation(); showProductImage('${product._id}', ${imgIndex})"></div>`
                ).join('')}
                            </div>
                            <div class="image-arrows">
                                <button class="arrow-btn" onclick="event.stopPropagation(); navigateProductImage('${product._id}', -1)">‚Üê</button>
                                <button class="arrow-btn" onclick="event.stopPropagation(); navigateProductImage('${product._id}', 1)">‚Üí</button>
                            </div>
                        ` : ''}
                    </div>
                `;
            } else {
                // Use placeholder image
                imageHtml = `
                    <div class="image-gallery">
                        ${badgeHTML}
                        <img src="${getPlaceholderImage()}" alt="${product.name}" class="product-image">
                        <div class="image-overlay"></div>
                        <div class="quick-actions">
                            <button style="color: #e74c3c;" class="quick-btn wishlist-btn ${wishlist.includes(product._id) ? 'active' : ''}" 
                                    onclick="event.stopPropagation(); toggleWishlist('${product._id}')" title="Add to Wishlist">
                                ${wishlist.includes(product._id) ? '‚ô•' : '‚ô°'}
                            </button>
                            <button class="quick-btn" onclick="event.stopPropagation(); openProductModal('${product._id}')" title="Quick View">üëÅ</button>
                        </div>
                    </div>
                `;
            }

            // Stock status
            const isOutOfStock = !product.inStock;
            const stockOverlay = isOutOfStock ? '<div class="out-of-stock-overlay">Out of Stock</div>' : '';

            // Add to cart button
            const addToCartButton = isOutOfStock ?
                '<button class="add-to-cart-btn" disabled>Out of Stock</button>' :
                `<button onclick="event.stopPropagation(); addToCart('${product._id}')" class="add-to-cart-btn">Add to Cart</button>`;

            // Rating stars
            const ratingStars = generateStarRating(product.rating || 0);

            // Discount display
            const hasDiscount = product.originalPrice && product.originalPrice > product.price;
            const discountHTML = hasDiscount ? `
                <div class="discount-price">
                    <div class="product-price">‚Çπ${product.price}</div>
                    <div class="original-price">‚Çπ${product.originalPrice}</div>
                    <div class="discount-percent">-${Math.round((1 - product.price / product.originalPrice) * 100)}%</div>
                </div>
            ` : `<div class="product-price">‚Çπ${product.price}</div>`;

            productCard.innerHTML = `
                ${imageHtml}
                ${stockOverlay}
                <div class="product-info">
                    <div class="product-category">${product.category || 'General'}</div>
                    <div class="product-name">${product.name}</div>
                    
                    ${product.rating ? `
                    <div class="product-rating">
                        <div class="rating-stars">${ratingStars}</div>
                        <div class="rating-count">(${product.reviewCount || 0})</div>
                    </div>
                    ` : ''}
                    
                    ${discountHTML}
                    
                    <div class="product-description">${product.description || 'No description available'}</div>
                    
                    <div class="product-actions">
                        ${addToCartButton}
                        <button class="view-details-btn" onclick="event.stopPropagation(); openProductModal('${product._id}')" title="View Details">
                            ‚ÑπÔ∏è
                        </button>
                    </div>
                </div>
            `;

            // Add click event to open modal
            productCard.addEventListener('click', (e) => {
                if (!e.target.closest('button')) {
                    openProductModal(product._id);
                }
            });

            return productCard;
        }

        // Generate star rating HTML
        function generateStarRating(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;

            for (let i = 0; i < 5; i++) {
                if (i < fullStars) {
                    stars += '‚òÖ';
                } else if (i === fullStars && hasHalfStar) {
                    stars += '‚≠ê';
                } else {
                    stars += '‚òÜ';
                }
            }

            return stars;
        }

        // Enhanced image navigation
        function showProductImage(productId, imageIndex) {
            const product = products.find(p => p._id === productId);
            if (!product || !product.images || imageIndex >= product.images.length) return;

            currentImageIndices[productId] = imageIndex;

            const productCard = document.querySelector(`[data-product-id="${productId}"]`);
            if (!productCard) return;

            const imageElement = productCard.querySelector('.product-image');
            const dots = productCard.querySelectorAll('.image-dot');
            const counter = productCard.querySelector('.image-counter');

            // Smooth image transition
            imageElement.style.opacity = '0';
            setTimeout(() => {
                imageElement.src = product.images.length > 0 ?
                    `${API_BASE.replace('/api', '')}/uploads/${product.images[imageIndex]}` :
                    getPlaceholderImage();
                imageElement.style.opacity = '1';
            }, 150);

            // Update navigation
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === imageIndex);
            });

            if (counter) {
                counter.textContent = `${imageIndex + 1}/${product.images.length}`;
            }
        }

        // Navigate product images with arrows
        function navigateProductImage(productId, direction) {
            const product = products.find(p => p._id === productId);
            if (!product || !product.images || product.images.length <= 1) return;

            const currentIndex = currentImageIndices[productId] || 0;
            let newIndex = currentIndex + direction;

            if (newIndex < 0) {
                newIndex = product.images.length - 1;
            } else if (newIndex >= product.images.length) {
                newIndex = 0;
            }

            showProductImage(productId, newIndex);
        }

        // Setup swipe listeners for mobile
        function setupSwipeListeners() {
            let touchStartX = 0;
            let touchEndX = 0;

            document.addEventListener('touchstart', e => {
                // Check if we're touching an image gallery
                if (e.target.closest('.image-gallery')) {
                    touchStartX = e.changedTouches[0].screenX;
                }
            });

            document.addEventListener('touchend', e => {
                // Check if we're releasing touch on an image gallery
                if (e.target.closest('.image-gallery')) {
                    touchEndX = e.changedTouches[0].screenX;
                    handleSwipe(e.target);
                }
            });

            function handleSwipe(element) {
                const swipeThreshold = 50;
                const swipeDistance = touchEndX - touchStartX;

                if (Math.abs(swipeDistance) > swipeThreshold) {
                    const productCard = element.closest('.product-card');
                    if (productCard) {
                        const productId = productCard.dataset.productId;
                        const product = products.find(p => p._id === productId);

                        if (product && product.images && product.images.length > 1) {
                            if (swipeDistance > 0) { // Swipe right
                                navigateProductImage(productId, -1);
                            } else { // Swipe left
                                navigateProductImage(productId, 1);
                            }
                        }
                    }
                }
            }
        }

        // Enhanced search functionality
        function searchProducts(query) {
            const searchTerm = query.toLowerCase().trim();

            if (!searchTerm) {
                filteredProducts = [...products]; // Show all products when search is empty
            } else {
                filteredProducts = products.filter(product => {
                    return product.name.toLowerCase().includes(searchTerm) ||
                        product.description.toLowerCase().includes(searchTerm) ||
                        product.category.toLowerCase().includes(searchTerm);
                });
            }

            displayProducts();
        }

        // Sort products
        function sortProducts() {
            const sortValue = document.getElementById('sortSelect').value;

            switch (sortValue) {
                case 'price-low':
                    filteredProducts.sort((a, b) => a.price - b.price);
                    break;
                case 'price-high':
                    filteredProducts.sort((a, b) => b.price - a.price);
                    break;
                case 'name':
                    filteredProducts.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'newest':
                    filteredProducts.sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));
                    break;
                case 'rating':
                    filteredProducts.sort((a, b) => (b.rating || 0) - (a.rating || 0));
                    break;
                default:
                    return;
            }

            displayProducts();
        }

        // Toggle between grid and list view
        function toggleView(view) {
            currentView = view;
            const grid = document.getElementById('productsGrid');

            // Update button states
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Update grid class
            grid.className = `products-grid ${view}-view`;

            // Update all product cards
            document.querySelectorAll('.product-card').forEach(card => {
                card.className = `product-card ${view}-view`;
            });
        }

        // Open product detail modal
        function openProductModal(productId) {
            const product = products.find(p => p._id === productId);
            if (!product) return;

            currentProduct = product;

            // Populate modal content
            document.getElementById('modalProductCategory').textContent = product.category || 'General';
            document.getElementById('modalProductName').textContent = product.name;

            // Handle rating
            if (product.rating) {
                document.getElementById('modalProductRating').textContent = generateStarRating(product.rating);
                document.getElementById('modalRatingCount').textContent = `(${product.reviewCount || 0} reviews)`;
            } else {
                document.getElementById('modalProductRating').textContent = '';
                document.getElementById('modalRatingCount').textContent = 'No reviews yet';
            }

            // Handle pricing
            const hasDiscount = product.originalPrice && product.originalPrice > product.price;
            if (hasDiscount) {
                document.getElementById('modalProductPrice').textContent = `‚Çπ${product.price}`;
                document.getElementById('modalOriginalPrice').textContent = `‚Çπ${product.originalPrice}`;
                document.getElementById('modalDiscountPercent').textContent = `-${Math.round((1 - product.price / product.originalPrice) * 100)}%`;
            } else {
                document.getElementById('modalProductPrice').textContent = `‚Çπ${product.price}`;
                document.getElementById('modalOriginalPrice').textContent = '';
                document.getElementById('modalDiscountPercent').textContent = '';
            }

            // Handle stock information
            const stockElement = document.getElementById('modalProductStock');
            if (product.inStock) {
                stockElement.textContent = 'In Stock';
                stockElement.className = 'product-stock';
            } else {
                stockElement.textContent = 'Out of Stock';
                stockElement.className = 'product-stock out';
            }

            // Handle SKU
            document.getElementById('modalProductSku').textContent = product.sku || 'N/A';

            document.getElementById('modalProductDescription').textContent = product.description || 'No description available';

            // Setup main image
            if (product.images && product.images.length > 0) {
                document.getElementById('modalMainImage').src = `${API_BASE.replace('/api', '')}/uploads/${product.images[0]}`;

                // Setup thumbnails
                const thumbnailStrip = document.getElementById('modalThumbnailStrip');
                thumbnailStrip.innerHTML = '';

                if (product.images.length > 1) {
                    product.images.forEach((image, index) => {
                        const thumb = document.createElement('img');
                        thumb.src = `${API_BASE.replace('/api', '')}/uploads/${image}`;
                        thumb.className = `modal-thumbnail ${index === 0 ? 'active' : ''}`;
                        thumb.onclick = () => showModalImage(index);
                        thumbnailStrip.appendChild(thumb);
                    });
                }
            } else {
                document.getElementById('modalMainImage').src = getPlaceholderImage();
                document.getElementById('modalThumbnailStrip').innerHTML = '';
            }

            // Setup color options
            const colorOptionsContainer = document.getElementById('modalColorOptions');
            if (product.colors && product.colors.length > 0) {
                colorOptionsContainer.innerHTML = '<p style="margin-bottom: 10px; font-weight: 600;">Color:</p>';
                product.colors.forEach((color, index) => {
                    const colorOption = document.createElement('div');
                    colorOption.className = `color-option ${index === 0 ? 'active' : ''}`;
                    colorOption.style.backgroundColor = color;
                    colorOption.title = `Color option ${index + 1}`;
                    colorOptionsContainer.appendChild(colorOption);
                });
            } else {
                colorOptionsContainer.innerHTML = '';
            }

            // Setup size options
            const sizeOptionsContainer = document.getElementById('modalSizeOptions');
            if (product.sizes && product.sizes.length > 0) {
                sizeOptionsContainer.innerHTML = '<p style="margin-bottom: 10px; font-weight: 600;">Size:</p>';
                product.sizes.forEach((size, index) => {
                    const sizeOption = document.createElement('div');
                    sizeOption.className = `size-option ${index === 0 ? 'active' : ''}`;
                    sizeOption.textContent = size;
                    sizeOptionsContainer.appendChild(sizeOption);
                });
            } else {
                sizeOptionsContainer.innerHTML = '';
            }

            // Setup add to cart button
            const addToCartBtn = document.getElementById('modalAddToCart');
            if (product.inStock) {
                addToCartBtn.disabled = false;
                addToCartBtn.textContent = 'Add to Cart';
                addToCartBtn.onclick = () => addToCart(productId);
            } else {
                addToCartBtn.disabled = true;
                addToCartBtn.textContent = 'Out of Stock';
            }

            // Show modal
            document.getElementById('productModal').style.display = 'block';
        }

        // Show specific image in modal
        function showModalImage(index) {
            if (!currentProduct || !currentProduct.images || index >= currentProduct.images.length) return;

            const mainImage = document.getElementById('modalMainImage');
            const thumbnails = document.querySelectorAll('.modal-thumbnail');

            // Update main image with transition
            mainImage.style.opacity = '0';
            setTimeout(() => {
                mainImage.src = `${API_BASE.replace('/api', '')}/uploads/${currentProduct.images[index]}`;
                mainImage.style.opacity = '1';
            }, 150);

            // Update thumbnail states
            thumbnails.forEach((thumb, i) => {
                thumb.classList.toggle('active', i === index);
            });
        }

        // Close product modal
        function closeProductModal() {
            document.getElementById('productModal').style.display = 'none';
            currentProduct = null;
        }

        // Image zoom functionality - Fixed to prevent cutoff
        function zoomImage(imageSrc) {
            const zoomImage = document.getElementById('zoomImage');
            zoomImage.src = imageSrc;

            const zoomModal = document.getElementById('zoomModal');
            zoomModal.style.display = 'block';

            // Center the image
            setTimeout(() => {
                zoomImage.style.margin = 'auto';
                zoomImage.style.display = 'block';
            }, 10);
        }

        // Close zoom modal
        function closeZoomModal() {
            document.getElementById('zoomModal').style.display = 'none';
        }

        // Wishlist functionality
        function toggleWishlist(productId) {
            const index = wishlist.indexOf(productId);
            const product = products.find(p => p._id === productId);

            if (index === -1) {
                wishlist.push(productId);
                showToast('success', `${product.name} added to wishlist! ‚ô•`);
            } else {
                wishlist.splice(index, 1);
                showToast('success', `${product.name} removed from wishlist`);
            }

            localStorage.setItem('wishlist', JSON.stringify(wishlist));
            updateWishlistCount();

            // Update all wishlist buttons for this product
            document.querySelectorAll(`[onclick*="${productId}"]`).forEach(btn => {
                if (btn.classList.contains('wishlist-btn')) {
                    btn.classList.toggle('active', wishlist.includes(productId));
                    btn.innerHTML = wishlist.includes(productId) ? '‚ô•' : '‚ô°';
                }
            });
        }

        // Update wishlist count
        function updateWishlistCount() {
            const wishlistCount = wishlist.length;
            document.getElementById('floatingWishlistCount').textContent = wishlistCount;
        }

        // Enhanced add to cart with animation
        function addToCart(productId) {
            const product = products.find(p => p._id === productId);
            if (!product) return;

            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: productId,
                    name: product.name,
                    price: product.price,
                    image: product.images && product.images.length > 0 ? product.images[0] : null,
                    quantity: 1,
                    category: product.category
                });
            }

            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();

            // Show success toast
            showToast('success', `${product.name} added to cart! üõí`);

            // Button animation
            const button = event.target;
            const originalText = button.textContent;
            const originalBg = button.style.background;

            button.textContent = 'Added! ‚úì';
            button.style.background = 'var(--success-gradient)';
            button.style.transform = 'scale(0.95)';

            setTimeout(() => {
                button.textContent = originalText;
                button.style.background = originalBg;
                button.style.transform = '';
            }, 1000);
        }

        // Enhanced cart functionality
        function updateCartCount() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const cartCountElement = document.getElementById('cartCount');
            const floatingCartCountElement = document.getElementById('floatingCartCount');

            cartCountElement.textContent = totalItems;
            floatingCartCountElement.textContent = totalItems;

            // Bounce animation for cart count
            if (totalItems > 0) {
                cartCountElement.style.animation = 'bounce 0.5s ease-in-out';
                floatingCartCountElement.style.animation = 'bounce 0.5s ease-in-out';
                setTimeout(() => {
                    cartCountElement.style.animation = '';
                    floatingCartCountElement.style.animation = '';
                }, 500);
            }
        }

        function openCart() {
            displayCartItems();
            document.getElementById('cartModal').style.display = 'block';
        }

        function closeCart() {
            document.getElementById('cartModal').style.display = 'none';
        }

        function displayCartItems() {
            const cartItemsContainer = document.getElementById('cartItems');
            const cartTotalContainer = document.getElementById('cartTotal');

            if (cart.length === 0) {
                cartItemsContainer.innerHTML = `
                    <div class="empty-cart">
                        <div class="empty-cart-icon">üõí</div>
                        <h3>Your cart is empty</h3>
                        <p>Add some amazing products to get started!</p>
                    </div>
                `;
                cartTotalContainer.textContent = 'Total: ‚Çπ0';
                return;
            }

            let cartHTML = '';
            let total = 0;

            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;

                cartHTML += `
                    <div class="cart-item">
                        <img src="${item.image ? `${API_BASE.replace('/api', '')}/uploads/${item.image}` : getPlaceholderImage()}" 
                             alt="${item.name}" class="cart-item-image">
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.name}</div>
                            <div class="cart-item-price">‚Çπ${item.price} each</div>
                            <div class="quantity-controls">
                                <button class="quantity-btn" onclick="updateQuantity('${item.id}', -1)">-</button>
                                <span class="quantity">${item.quantity}</span>
                                <button class="quantity-btn" onclick="updateQuantity('${item.id}', 1)">+</button>
                                <button class="remove-item" onclick="removeFromCart('${item.id}')">Remove</button>
                            </div>
                        </div>
                        <div style="font-weight: bold; background: var(--success-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-size: 18px;">
                            ‚Çπ${itemTotal}
                        </div>
                    </div>
                `;
            });

            cartItemsContainer.innerHTML = cartHTML;
            cartTotalContainer.textContent = `Total: ‚Çπ${total}`;
        }

        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (!item) return;

            item.quantity += change;
            if (item.quantity <= 0) {
                removeFromCart(productId);
                return;
            }

            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            displayCartItems();
        }

        function removeFromCart(productId) {
            const removedItem = cart.find(item => item.id === productId);
            cart = cart.filter(item => item.id !== productId);
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            displayCartItems();

            if (removedItem) {
                showToast('success', `${removedItem.name} removed from cart`);
            }
        }

        // Enhanced checkout functionality
        async function checkAvailability() {
            if (cart.length === 0) {
                showToast('error', 'Your cart is empty! Add some products first.');
                return;
            }

            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

            // Add category info to cart items
            const enhancedItems = cart.map(cartItem => {
                const product = products.find(p => p._id === cartItem.id);
                return {
                    ...cartItem,
                    category: product ? product.category : 'Unknown',
                    description: product ? product.description : ''
                };
            });

            try {
                showToast('success', 'Preparing your order... üì±');

                const response = await fetch(`${API_BASE}/check-availability`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        items: enhancedItems,
                        total
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    showToast('success', 'Opening WhatsApp... üöÄ');

                    // Open WhatsApp with a slight delay
                    setTimeout(() => {
                        window.open(data.whatsappUrl, '_blank');
                        showToast('success', 'Order sent! Wait for confirmation on WhatsApp.');
                    }, 1500);
                } else {
                    showToast('error', data.message || 'Failed to send order');
                }
            } catch (error) {
                console.error('Checkout error:', error);
                showToast('error', 'Network error. Please check your connection and try again.');
            }
        }

        // Clear cart with confirmation
        function clearCart() {
            if (cart.length === 0) {
                showToast('error', 'Cart is already empty!');
                return;
            }

            if (confirm('üóëÔ∏è Clear all items from cart?')) {
                cart = [];
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                displayCartItems();
                showToast('success', 'Cart cleared successfully!');
            }
        }

        // Enhanced toast notification system
        function showToast(type, message) {
            const toast = document.getElementById('toast');
            const icon = toast.querySelector('.toast-icon');
            const messageEl = toast.querySelector('.toast-message');

            // Set content
            messageEl.textContent = message;

            // Set type and icon
            toast.className = `toast toast-${type}`;
            icon.textContent = type === 'success' ? '‚úÖ' : '‚ùå';

            // Show toast
            toast.classList.add('show');

            // Hide after 4 seconds
            setTimeout(() => {
                toast.classList.remove('show');
            }, 4000);
        }

        // Placeholder image generator
        function getPlaceholderImage() {
            return 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjI1MCIgdmlld0JveD0iMCAwIDMwMCAyNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMjUwIiBmaWxsPSIjRjhGOUZBIi8+CjxjaXJjbGUgY3g9IjE1MCIgY3k9IjEwMCIgcj0iMzAiIGZpbGw9IiNEREREREQiLz4KPHJlY3QgeD0iMTAwIiB5PSIxNDAiIHdpZHRoPSIxMDAiIGhlaWdodD0iNjAiIHJ4PSIxMCIgZmlsbD0iI0RERERERCIvPgo8L3N2Zz4K';
        }

        // Ripple effect for buttons
        function createRipple(event) {
            const button = event.currentTarget;
            const circle = document.createElement('span');
            const diameter = Math.max(button.clientWidth, button.clientHeight);
            const radius = diameter / 2;

            circle.style.width = circle.style.height = `${diameter}px`;
            circle.style.left = `${event.clientX - button.getBoundingClientRect().left - radius}px`;
            circle.style.top = `${event.clientY - button.getBoundingClientRect().top - radius}px`;
            circle.classList.add('ripple');

            const ripple = button.getElementsByClassName('ripple')[0];
            if (ripple) {
                ripple.remove();
            }

            button.appendChild(circle);
        }

        // Enhanced error handling
        window.addEventListener('error', (event) => {
            console.error('Global error:', event.error);
            showToast('error', 'Something went wrong. Please refresh the page.');
        });

        // Performance optimization - Lazy loading for images
        function lazyLoadImages() {
            const images = document.querySelectorAll('img[data-src]');
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;
                        img.classList.remove('lazy');
                        imageObserver.unobserve(img);
                    }
                });
            });

            images.forEach(img => imageObserver.observe(img));
        }

        // Initialize lazy loading when DOM is ready
        document.addEventListener('DOMContentLoaded', lazyLoadImages);

        // Add smooth scrolling for better UX
        document.documentElement.style.scrollBehavior = 'smooth';

        // Add loading states for buttons
        function setButtonLoading(button, loading = true) {
            if (loading) {
                button.disabled = true;
                button.dataset.originalText = button.textContent;
                button.innerHTML = '<div class="loading-spinner" style="width: 20px; height: 20px; margin: 0 auto;"></div>';
            } else {
                button.disabled = false;
                button.textContent = button.dataset.originalText || 'Action';
            }
        }

        // Add keyboard navigation support
        document.addEventListener('keydown', (e) => {
            // Navigate through products with arrow keys
            if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
                const products = document.querySelectorAll('.product-card');
                const focused = document.activeElement;
                const currentIndex = Array.from(products).indexOf(focused);

                if (currentIndex !== -1) {
                    const nextIndex = e.key === 'ArrowRight'
                        ? (currentIndex + 1) % products.length
                        : (currentIndex - 1 + products.length) % products.length;

                    products[nextIndex].focus();
                    e.preventDefault();
                }
            }

            // Quick add to cart with Space key
            if (e.key === ' ' && document.activeElement.classList.contains('product-card')) {
                const productId = document.activeElement.dataset.productId;
                if (productId) {
                    addToCart(productId);
                    e.preventDefault();
                }
            }
        });

        console.log('üéâ Enhanced Shop UI loaded successfully!');
    </script>
</body>

</html>